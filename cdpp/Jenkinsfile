pipeline {
    agent any

    tools {
        maven 'Maven 3.9.9'  // Jenkins에서 설정한 Maven 이름 (여기서 'Maven 3.8.4'는 설치한 Maven 이름)
    }

    stages {
        stage('Checkout') {
            steps {
                // Git 저장소에서 코드 가져오기
                checkout scm
            }
        }

        stage('Build') {
            steps {
                // PowerShell을 사용하여 Maven 빌드 실행
                script {
                    // PowerShell에서 mvn clean install을 실행하여 빌드를 진행
                    powershell 'mvn clean install'
                }
            }
        }

        stage('Run Application') {
            steps {
                // PowerShell을 사용하여 애플리케이션 실행 명령어
                script {
                    // 예시로 Spring Boot 애플리케이션 실행 (JAR 파일을 실행)
                    powershell 'java -jar target/your-app.jar'
                }
            }
        }
    }

    post {
        always {
            // 빌드 후 항상 실행되는 코드 (예: 빌드 로그 출력 등)
            echo 'Pipeline finished.'
        }

        success {
            // 빌드가 성공하면 실행되는 코드
            echo 'Build Successful!'
        }

        failure {
            // 빌드가 실패하면 실행되는 코드
            echo 'Build Failed!'
        }
    }
}
